function returnCodeMode(){var e={1:"text/x-csrc",2:"text/x-c++src",3:"text/x-java",4:"text/x-ruby",5:"text/x-python",6:"text/x-perl",7:"text/x-csharp",8:"text/x-mysql",9:"text/x-pgsql"};return e={},$("#submission_language_id option").each(function(){e[$(this).val()]=$(this).attr("data-language-mime-type")}),e}function returnCodeContent(e){return codeContent={},attr_to_be_picked="","saved"==e?attr_to_be_picked="data-language-saved-code":"initial"==e&&(attr_to_be_picked="data-language-skeletal-text"),$("#submission_language_id option").each(function(){codeContent[$(this).val()]=JSON.parse($(this).attr(attr_to_be_picked))}),codeContent}function inner_html_generator(e,t,n,s,a,i){if("header"==e){var l="<thead>",r="<tr><th>#</th><th>Input</th><th>Expected O/p</th><th>Actual O/p</th>",o="</thead>",c="<th> CPU Time (Sec)</th>",d="<th> Memory Used (KB)</th>";return 1==t&&1==n?l+r+c+d+o:1==t?l+r+c+o:1==n?l+r+d+o:l+r+o}var u="<td>"+Number(a)+"</td><td class='break-words'>"+s[i].inp+"</td><td class='break-words'>"+s[i].exp+"</td><td class='break-words'>"+s[i].act+"</td>",m="<td>"+s[i].cpu_time+"</td>",p="<td>"+s[i].memory_usage+"</td>";return 1==t&&1==n?u+m+p:1==t?u+m:1==n?u+p:u}function updateClipboard(e){""!=e&&null!=e&&(user_event_id=$(".hidden_event_data_url").attr("data-user-event-id"),""!=user_event_id&&(update_clipboard_text_path=$(".hidden_event_data_url").attr("data-update-clipboard-text-path"),$.post(update_clipboard_text_path,{selected_text:e})))}function setInnerHtmlByClass(e,t){elements=document.querySelectorAll("."+e),[].slice.call(elements).forEach(function(e){e.innerHTML=t})}function appendChildByClassElement(e,t){elements=document.querySelectorAll("."+e),[].slice.call(elements).forEach(function(e){e.appendChild(t)})}if($(document).ready(function(){let e=document.getElementById("submission_code_submission_mode_file_upload");if(!e){$(".show_test_case").click(function(){$(".user_test_case").slideToggle()});var t={};code_run_flag="inactive";var n=returnCodeMode();function s(){t=returnCodeContent("initial");var e=$(".file-tab.selected").attr("title");l.setValue(t[$("#submission_language_id").val()][e])}t=returnCodeContent("saved"),$("#resetConfirmButton").on("click",s);var a=function(){t[$("#submission_language_id").val()][$(".file-tab.selected").attr("title")]=l.getValue(),$("#submission_program_text").val(JSON.stringify(t[$("#submission_language_id").val()])),$("#new_submission").submit()};$(".compile_submission").bind("click",a);var i=0,l=CodeMirror.fromTextArea(document.getElementById("submission_program_text"),{mode:n[$("#submission_language_id").val()],lineNumbers:!0,lineWrapping:!0,styleActiveLine:!0,styleSelectedText:!0,autoCloseBrackets:!0,matchBrackets:!0,foldGutter:!0,lint:!1,keyMap:"sublime",gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],extraKeys:{"Ctrl-Space":"autocomplete","Ctrl-Q":function(e){e.foldCode(e.getCursor())}},theme:"solarized",indentUnit:2});function r(e){var t="| "+e.getOption("keyMap")+" | "+e.getOption("indentUnit")+" spaces |";$("#codemirror_options").text(t)}$("#codemirror_options").on("click",function(){$("#editorCustomModal").modal("toggle")}),r(l),l.on("change",function(){i++,coderec.captureframe(document.getElementById("prob_elems")),$("#file-save").fadeOut(4800),i>5&&(i=0,t[$("#submission_language_id").val()][$(".file-tab.selected").attr("title")]=l.getValue(),$("#submission_submission_type").val("draft"),$("#submission_program_text").val(JSON.stringify(t[$("#submission_language_id").val()])),$("#new_submission").submit(),$("#submission_submission_type").val("submit"))}),l.on("cursorActivity",function(e){var t=e.doc.getCursor().line+1,n=e.doc.getCursor().ch+1;$("#cursor_position").text(t+":"+n)});var o=CodeMirror.fromTextArea(document.getElementById("program_text_demo"),{mode:n[$("#submission_language_id").val()],lineNumbers:!0,lineWrapping:!0,styleActiveLine:!0,styleSelectedText:!0,autoCloseBrackets:!0,matchBrackets:!0,lint:!1,keyMap:"sublime",gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],extraKeys:{"Ctrl-Space":"autocomplete","Ctrl-Q":function(e){e.foldCode(e.getCursor())}},theme:"solarized",indentUnit:2,readOnly:!0});function c(e,t){$(e+" option").each(function(){if(this.value==t)return $(e).selectpicker("val",t),!1})}function d(e,t,n){return 4==t?e=(e=e.replace(new RegExp("\n    ","g"),"\n        ")).replace(new RegExp("\n  ","g"),"\n    "):4==n&&(e=(e=e.replace(new RegExp("\n    ","g"),"\n  ")).replace(new RegExp("\n        ","g"),"\n    ")),e}function u(){var e='{"indent":"'+$(".selectpicker_indent").val()+'", "theme":"'+$(".selectpicker_theme").val()+'", "editor":"'+$(".selectpicker_editor").val()+'"}';return JSON.parse(e)}function m(){var e=u();p(e.indent,e.theme,e.editor)}function p(e,t,n){o.setOption("indentUnit",parseInt(e)),o.setOption("theme",t),o.setOption("keyMap",n)}$(".selectpicker_editor").selectpicker(),$(".selectpicker_editor").change(function(){$("#custom_theme_save_button").addClass("btn-success"),m()}),$(".selectpicker_theme").selectpicker(),$(".selectpicker_theme").change(function(){$("#custom_theme_save_button").addClass("btn-success"),m()}),$(".selectpicker_indent").selectpicker(),$(".selectpicker_indent").change(function(){$("#custom_theme_save_button").addClass("btn-success");var e=o.getValue(),t=$(".selectpicker_indent").val(),n=d(e,t,2==t?4:2);o.setValue(n),m()}),$("#editorCustomModal").on("shown.bs.modal",function(){$("#custom_theme_save_button").removeClass("btn-success");var e=l.getOption("theme"),t=l.getOption("keyMap"),n=l.getOption("indentUnit");c(".selectpicker_theme",e),c(".selectpicker_indent",n),c(".selectpicker_editor",t);var s=$(".file-tab.selected").attr("title"),a=s.substr(s.indexOf(".")+1),i=JSON.parse($("#program_text_demo").attr("data-languages-sample-text"));o.setValue(d(i[a].stubs,$(".selectpicker_indent").val(),0)),o.refresh(),m()}),$("#custom_theme_save_button").on("click",function(){var e=u();g(e.indent,e.theme,e.editor)});const e=document.getElementById("upload_file_for_editor"),y=document.getElementById("upload_file_for_editor_input"),k=document.getElementById("choose_file_dummy_view_upload_file"),x=document.getElementById("select_upload_file"),w=document.getElementById("upload_file_submit"),E=document.getElementById("language_select"),I=e=>{e.addEventListener("click",function(e){y&&y.click(),e.preventDefault()},!1)};I(k),I(x),y.addEventListener("change",()=>M()),w.addEventListener("click",()=>S());let M=()=>{let e=y.files;if(e.length){let t=e[0];k.value=t.name}else alert("No files selected!")},S=()=>{let n=y.files;if(n.length){let s=n[0];if(s&&s.size<=5e6){let n=new FileReader;n.readAsText(s,"UTF-8"),n.onload=function(n){let s=n.target.result,a=document.getElementById("submission_language_id"),i=t[E.value];i[Object.keys(i)[0]]=s,a.value=E.value;var l=new Event("change");a.dispatchEvent(l),document.getElementById("uploadFileFormat").reset(),e.click()},n.onerror=function(){alert("error reading file")}}else s&&s.size>5e6&&alert("File is too large")}else alert("No files selected!")};function _(e){var n=0;for(var s in document.getElementById("file-tabs").innerHTML="",e)if(e.hasOwnProperty(s)){var a=document.createElement("div");a.title=s,a.className="col-sm-12 col-md-12 file-tab hide-overflow",0==n&&(a.className+=" selected");var i=document.createElement("span");i.style.zIndex=1,i.style.position="relative",i.innerHTML=s,a.appendChild(i),document.getElementById("file-tabs").appendChild(a),0==n&&(setTimeout(function(){l.setValue(e[s])},1),n++)}$(".file-tab").click(function(){t[$("#submission_language_id").val()][$(".file-tab.selected").attr("title")]=l.getValue(),$(".file-tab.selected").removeClass("selected"),$(this).addClass("selected");var e=$(this).attr("title");l.setValue(t[$("#submission_language_id").val()][e])})}function g(e,t,n){l.setOption("indentUnit",parseInt(e)),l.setOption("theme",t),l.setOption("keyMap",n),C(e,t,n),r(l)}function h(e){return null==e||"undefined"==e||""==e||"null"==e}if($("#submission_language_id").on("focus",function(){var e=document.getElementById("submission_language_id"),t=e.options[e.selectedIndex].value;$("#language_"+t).text(l.getValue())}).change(function(){var e=document.getElementById("submission_language_id");e.options[e.selectedIndex].value;_(t[$("#submission_language_id").val()]);var s=$("#submission_language_id").val(),a=$("#submission_language_id").html();a=(a=a.replace(' selected="selected"',"")).replace('"'+s+'"','"'+s+'" selected="selected"'),$("#submission_language_id").html(a),l.setOption("mode",n[$("#submission_language_id").val()]),o.setOption("mode",n[$("#submission_language_id").val()])}),_(t[$("#submission_language_id").val()]),$("#expand").click(function(){$("#instr-btn").hasClass("clicked")?($("#instr-btn").click(),$(this).addClass("instr")):$("#exec-btn").hasClass("clicked")?($("#exec-btn").click(),$(this).addClass("exec")):$(this).hasClass("exec")?($("#exec-btn").click(),$(this).removeClass("exec")):$(this).hasClass("instr")?($("#instr-btn").click(),$(this).removeClass("instr")):$("#instr-btn").click()}),$("#instr-btn, #exec-btn").click(function(){$(this).hasClass("clicked")?$("#expand").hasClass("fa-expand")&&($("#expand").removeClass("fa-expand"),$("#expand").addClass("fa-columns")):$("#expand").hasClass("fa-columns")&&($("#expand").removeClass("fa-columns"),$("#expand").addClass("fa-expand"))}),$("#code_run").click(function(){if("active"==code_run_flag)return!1;code_run_flag="active",$(".compile_submission").unbind("click",a),$("#code_run").css("opacity",.3),window.disable_compile_and_run=!0,window.wait_to_enable_compile_and_run=setInterval(function(){0==window.disable_compile_and_run&&(clearInterval(wait_to_enable_compile_and_run),setTimeout(function(){$("#code_run").css("opacity",1),$(".compile_submission").bind("click",a),code_run_flag="inactive"},4e3))},1e3),$("#exec-btn").hasClass("clicked")||$("#exec-btn").click()}),$(".menu-item").click(function(){var e=$(this).attr("rel");$(this).hasClass("clicked")?($(this).removeClass("clicked"),$(e).toggle(),$(e).removeClass("panel-show"),$("#code-panel").removeClass("col-sm-6"),$("#code-panel").removeClass("col-md-6"),$("#code-panel").addClass("col-md-11"),$("#code-panel").addClass("col-sm-11")):$(".menu-item").hasClass("clicked")?($(".menu-item.clicked").removeClass("clicked"),$(".menu-panel.panel-show").toggle(),$(".menu-panel.panel-show").removeClass("panel-show"),$(this).addClass("clicked"),$(e).toggle(),$(e).addClass("panel-show")):($(this).addClass("clicked"),$(e).toggle(),$(e).addClass("panel-show"),$("#code-panel").removeClass("col-sm-11"),$("#code-panel").removeClass("col-md-11"),$("#code-panel").addClass("col-sm-6"),$("#code-panel").addClass("col-md-6"))}),$(document).ready(function(){l.refresh()}),$(".new_submission").on("ajax:success",function(){$("#file-save").fadeIn()}),$(".selectpicker").selectpicker(),$(".selectpicker").change(function(){var e=$(".selectpicker").val();g(e[2],e[1],e[0])}),"undefined"!=typeof Storage){var f=localStorage.getItem("codemirror_theme"),b=localStorage.getItem("codemirror_keymap"),v=localStorage.getItem("codemirror_indentation");h(f)||h(b)||h(v)?(localStorage.setItem("codemirror_theme",l.getOption("theme")),localStorage.setItem("codemirror_keymap",l.getOption("keyMap")),localStorage.setItem("codemirror_indentation",l.getOption("indentUnit"))):(g(v,f,b),$(".selectpicker").selectpicker("val",[v,b,f]),p(v,f,b),$(".selectpicker_theme").selectpicker("val",f),$(".selectpicker_indent").selectpicker("val",v),$(".selectpicker_editor").selectpicker("val",b))}else console.log("Local Storage Not supported");function C(e,t,n){"undefined"!=typeof Storage&&(localStorage.setItem("codemirror_indentation",e),localStorage.setItem("codemirror_theme",t),localStorage.setItem("codemirror_keymap",n))}!function(){coderec=new codeRecorder,coderec.captureframe(document.getElementById("prob_elems"));setInterval(function(){var e=coderec.getCodeRecording();""==e?console.log("nothing to send"):pushData(socket,"coding",e)},12e4)}(),window.addEventListener("beforeunload",function(){var e=coderec.getCodeRecording();""==e?console.log("nothing to send"):pushData(socket,"coding",e),pushData(socket,"coding",e)}),"cut_paste_disabled"==$("#submission_program_text").attr("data-ui-options")&&(l.on("paste",function(e,t){return t.preventDefault(),user_event_id=$(".hidden_event_data_url").attr("data-user-event-id"),""!=user_event_id&&(get_clipboard_text_path=$(".hidden_event_data_url").attr("data-get-clipboard-text-path"),$.get(get_clipboard_text_path,{},function(e){1==e.text_available?l.replaceSelection(e.text):toastr.warning("Copy paste not allowed in this coding challenge!")})),!1}),l.on("copy",function(e,t){return t.preventDefault(),selected_text=l.getSelection(),updateClipboard(selected_text),!1}),l.on("cut",function(e,t){return t.preventDefault(),selected_text=l.getSelection(),updateClipboard(selected_text),l.replaceSelection(""),!1})),$("#instr-body").bind("copy paste",function(e){return toastr.warning("Copy paste not allowed in this coding challenge!"),e.preventDefault(),!1})}$("#code_run").on("click",function(){ga("send","event","button","click","code_submission")}),$("tab-close").click(function(){$(this).parentNode.parentNode.removeChild($(this).parentNode)}),function(){function e(){alert("Your last compiled code will be taken as your final submission. Please remember to submit your code before the completion of test")}function t(e){e<=1200&&$("#timer_background").each(function(){this.style.setProperty("color","#FFF","important"),this.style.setProperty("border-bottom","1px solid #d9534f","important"),this.style.setProperty("background-color","#d9534f","important")})}function n(e){0==e&&(window.onbeforeunload=null,location.reload());var t=Math.floor(e/3600),n=Math.floor(e/60)-60*t,s=n<10?"0"+String(n):String(n),a=e-60*n-3600*t,i=a<10?"0"+String(a):String(a);$(".clocktimer").html(String(t)+":"+s+":"+i)}var s=document.querySelector(".clocktimer").dataset,a=s.clocktimer,i=`alert_for_user_event_${s.userEventId}`,l=!localStorage.getItem(i),r=!0;setInterval(function(){n(--a),a<=1200&&r&&(t(a),r=!1,l&&(localStorage.setItem(i,!0),e()))},1e3)}(),e&&$("#submission-file-upload-wrap").height($(window).height()-88),$(".CodeMirror").height($(window).height()-116),$("#instr-body").height($(window).height()-88),$("#exec-body").height($(window).height()-88),$("#fldr-body").height($(window).height()-88),$("#left-panel").height($(window).height()),window.onresize=function(){$(".CodeMirror").height($(window).height()-116),$("#instr-body").height($(window).height()-88),$("#exec-body").height($(window).height()-88),$("#fldr-body").height($(window).height()-88),$("#left-panel").height($(window).height())}}),$("#exec-close, #instr-close, #vid-close").click(function(){var e="#"+$(this).attr("id").replace("close","btn");$(e).click()}),$(".vid-item").click(function(){$(this).hasClass("clicked")?($(this).removeClass("clicked"),$("#videoreplay").toggle("slide")):($(this).addClass("clicked"),$("#videoreplay").toggle("slide"))}),document.getElementById("submission_code_submission_mode_file_upload"))testresults=function(){};else var testresults=function(e,t,n,s){if(setInnerHtmlByClass("submission_result",'<div class="alert alert-info">'+e.status+"</div>"),coderec.captureframe(document.getElementById("prob_elems")),"success"==e.status){var a=0,i=0,l=0,r=0,o=0,c=document.createElement("table"),d=0;c.className="table";var u=0,m=document.createElement("table");m.className="table","true"==n&&(n=!0),"true"==s&&(s=!0),c.innerHTML=inner_html_generator("header",n,s,"","",""),m.innerHTML=inner_html_generator("header",n,s,"","","");var p=!1;for(index in e)e.hasOwnProperty(index)&&(e[index].battery_test_id==t?(d++,"success"==e[index].status?(a++,testRes=document.createElement("tr"),testRes.className="success",testRes.innerHTML=inner_html_generator("table_row",n,s,e,d,index),c.appendChild(testRes)):"failure"==e[index].status?(i++,testRes=document.createElement("tr"),testRes.className="danger",testRes.innerHTML=inner_html_generator("table_row",n,s,e,d,index),c.appendChild(testRes)):e[index].status!=undefined&&(i++,testRes=document.createElement("tr"),testRes.className="danger",testRes.innerHTML=inner_html_generator("table_row",n,s,e,d,index),c.appendChild(testRes))):"true"==e[index].custom_test?(p=!0,u++,testRes=document.createElement("tr"),"success"==e[index].status?testRes.className="success":testRes.className="danger",testRes.innerHTML=inner_html_generator("table_row",n,s,e,u,index),m.appendChild(testRes)):(o+=1,"success"==e[index].status?l++:"failure"!=e[index].status&&e[index].status==undefined||r++));c.innerHTML+="</tbody>",m.innerHTML+="</tbody>",success_pc=100*a/(a+i),fail_pc=100*i/(a+i);var _=document.createElement("div");_.className="panel panel-default";var g=document.createElement("div");g.className="panel-heading",g.innerHTML="Test Cases";var h=document.createElement("div");h.innerHTML="Custom Test Cases",h.style.fontWeight="bold",h.style.marginLeft="20px",h.style.marginTop="20px";var f=document.createElement("div");f.className="panel-body";var b=document.createElement("div");b.innerHTML="Visible Test Cases",b.style.fontWeight="bold",b.style.marginLeft="20px",b.style.marginTop="20px";var v=document.createElement("div");v.className="panel-body";var $=document.createElement("div");$.className="progress";var C=document.createElement("div");C.className="progress-bar progress-bar-danger",C.style.width=fail_pc+"%",C.innerHTML="Fail&nbsp;"+i+"/"+(a+i);var y=document.createElement("div");if(y.className="progress-bar progress-bar-success",y.style.width=success_pc+"%",y.innerHTML="Success&nbsp;"+a+"/"+(a+i),$.appendChild(C),$.appendChild(y),v.appendChild($),_.appendChild(g),p&&(_.appendChild(h),_.appendChild(f),_.appendChild(m)),_.appendChild(b),_.appendChild(v),_.appendChild(c),(M=document.createElement("div")).className="alert alert-success",M.innerHTML="Compilation Successful",submission_result=document.querySelectorAll(".submission_result"),setInnerHtmlByClass("submission_result",""),appendChildByClassElement("submission_result",M),appendChildByClassElement("submission_result",_),o>=2){pseudo_success_pc=100*l/(l+r),pseudo_fail_pc=100*r/(l+r);var k=document.createElement("div");k.innerHTML="Hidden Test Cases",k.style.fontWeight="bold",k.style.marginLeft="20px",k.style.marginTop="20px";var x=document.createElement("div");x.className="panel-body";var w=document.createElement("div");w.className="progress";var E=document.createElement("div");E.className="progress-bar progress-bar-danger",E.style.width=pseudo_fail_pc+"%",E.innerHTML="Fail&nbsp;"+r+"/"+(l+r);var I=document.createElement("div");I.className="progress-bar progress-bar-success",I.style.width=pseudo_success_pc+"%",I.innerHTML="Success&nbsp;"+l+"/"+(l+r),w.appendChild(E),w.appendChild(I),x.appendChild(w),_.appendChild(k),_.appendChild(x)}}else if("compile error"==e.status){(M=document.createElement("div")).className="alert alert-danger",M.innerHTML="<strong>Compilation Failed!</strong><br><br><pre class='text-nowrap well well-sm'>"+e.errors+"</pre>",setInnerHtmlByClass("submission_result",""),appendChildByClassElement("submission_result",M)}else if("internal error"==e.status){clearInterval(check_for_results),(M=document.createElement("div")).className="alert alert-danger",M.innerHTML="Internal error! Please resubmit your code and contact the coordinator if problem persists",setInnerHtmlByClass("submission_result",""),appendChildByClassElement("submission_result",M)}else if("timeout"==e.status)clearInterval(check_for_results),setInnerHtmlByClass("submission_result",'<div class="alert alert-warning"><%= @status %>. Please check your code might have infinite loops.</div>');else if("runtime_error"==e.status){var M;(M=document.createElement("div")).className="alert alert-danger",M.innerHTML="<strong>Runtime Error</strong><br><br><pre class='text-nowrap well well-sm'>"+e.errors+"</pre>",setInnerHtmlByClass("submission_result",""),appendChildByClassElement("submission_result",M)}coderec.captureframe(document.getElementById("prob_elems"))};